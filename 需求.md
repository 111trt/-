# 全球物流网络模拟器 - 后续开发需求说明（中国 ↔ 欧洲走廊·阶段版）

---

## 1. 本阶段目标与边界

### 1.1 阶段目标

- 聚焦「中国 ↔ 欧洲」跨境物流走廊，搭建一套可运行的端到端原型：
  - 前端：用户在地图上自由搭建网络（节点 + 连线），然后选择优化类型（最快 / 最便宜 / 低碳 / 综合），由 AI 自动生成具体运输方案。
  - 后端：基于用户画出的「骨架网络」，结合行业默认参数、关税与清关规则、用户配置的突发事件，计算最优多式联运路径。
  - 配置：所有关键参数可在后台调整（运输方式参数、关税规则、清关时间、事件影响系数等），支持一键恢复为默认值。

### 1.2 范围限定

- 地理范围：优先支持中国 ↔ 欧洲主通道（含典型枢纽城市、港口、机场、铁路节点），后续再扩展至北美、东南亚等。
- 运输方式：公路、公铁联运、远洋海运、航空货运（多式联运组合）。
- 数据精度：采用「行业大概值 + 典型线路示意」为主的模拟，暂不追求完全真实运价与时刻表。
- 地图服务：沿用当前的高德地图前端 JS API，并使用高德 Web 服务（服务端）做公路距离与时效计算（通过环境变量配置 Web 服务 key，不写入前端代码）。

---

## 2. 用户交互流程（两阶段）

### 2.1 阶段一：用户搭建网络骨架（手工设计）

- 用户在地图上：
  - 添加节点：港口、机场、铁路场站、仓库、区域分拨中心等。
  - 节点属性：名称、类型（港口/机场/铁路/仓库）、等级（全球 / 区域 / 地方）、所属国家/区域、经纬度等。
  - 连线操作：
    - 仅表示「这两个节点之间存在潜在可达关系」，不在此阶段指定运输方式。
    - 支持两种连线模式：
      - 起点固定（从一个枢纽向多个节点发散）。
      - 接力连线（上一条线的终点自动作为下一条线的起点）。
  - 此阶段不弹出任何 AI 相关弹窗，也不做动画，仅画出网络拓扑。

### 2.2 阶段二：AI 规划运输方式与最优路径

- 用户在完成网络设计后：
  - 选择一个起点节点（中国侧）与终点节点（欧洲侧）。
  - 在「AI 规划」区域选择优化目标：
    - 最快（时间优先）
    - 最便宜（成本优先）
    - 低碳（碳排放优先）
    - 综合（可配置权重，例如时间 40% / 成本 40% / 碳排 20%）
  - 后端接收：
    - 当前骨架网络（节点 + 无模式的连线）
    - 用户选择的起点/终点 + 货量/货类（简化）
    - 当前启用的关税与清关规则
    - 当前用户配置的突发事件
  - 后端在此基础上自动为每条潜在连线分配候选运输方式，并通过图算法计算最优路径：
    - 最终给出一条或多条多段路径：
      - 某段用空运，某段用铁路，某段用公路 / 海运，顺序由 AI 决定，不是固定的「先空运再陆运」。

---

## 3. 突发事件与参数配置需求

### 3.1 事件类型与前端交互

- 事件类型（面向用户）：
  - 天气事件：台风、暴雪、大雾等，影响某区域交通。
  - 港口/机场拥堵：导致处理时间延长、吞吐能力下降。
  - 关税/政策变化：某国临时关税上调 / 下调、禁运、额外检查。
  - 铁路/公路中断：线路封锁、事故、罢工等。

- 前端操作方式：
  - 用户从侧边栏选择某个事件类型，进入事件放置模式。
  - 在地图上点击位置（或框选区域），配置事件参数：
    - 作用范围：中心坐标 + 半径 / 选中节点 / 选中线路。
    - 生效时间段（本阶段可简化为立即生效、长期有效）。
    - 影响参数（见 3.2）。
  - 事件以明显图形标识显示在地图上，可点击查看详情、启用/禁用或删除。

### 3.2 事件参数模型（可后台调整）

所有事件参数需要：
- 支持后台配置界面进行修改。
- 支持一键恢复为「默认行业值」。

示例参数（默认建议）：

- 天气事件（台风类）：
  - 覆盖半径：默认 2000 km。
  - 时间影响系数：耗时 × `1.5`。
  - 成本影响系数：成本 × `1.2`（绕行、燃油消耗增加）。
  - 影响运输方式：优先影响海运和空运，其次公路，铁路影响较小。

- 港口/机场拥堵：
  - 附加等待时间：默认 24–72 小时。
  - 成本影响：可能增加堆存费、改道费。

- 关税/政策事件：
  - 关税上调比例：如 +20%。
  - 清关时间增加：如 +12 小时。

- 线路中断事件：
  - 将某些连线暂时标记为「不可用」，算法在规划时禁止使用这部分边。

### 3.3 参数配置与重置需求

- 参数调节入口：前端 + 后端共同配合
  - 在前端提供「参数面板」（例如侧边滑出或弹窗形式），允许业务用户实时调节：
    - 运输方式参数（见 4.3）。
    - 关税与清关规则的关键系数（例如关税率区间、清关时间范围）。
    - 各类突发事件的影响系数（时间、成本、概率等）。
  - 参数修改后：
    - 立即生效于当前会话中的 AI 规划与仿真。
    - 同时通过 API 提交到后端进行持久化保存，保证刷新页面后仍能保留配置。

- 参数版本与恢复能力：
  - 所有参数需区分：
    - 默认值（系统提供的行业参考值）
    - 当前值（用户调整后的值）
  - 前端参数面板需支持：
    - 查看当前值与默认值。
    - 单个参数恢复默认值。
    - 一键将全部参数恢复为默认值（需确认提示）。

---

## 4. 多式联运与行业默认参数

### 4.1 适用运输方式（中国 ↔ 欧洲）

- 公路（ROAD）
- 铁路（RAIL）：中欧班列类通道。
- 海运（SEA）：中国沿海港口 ↔ 欧洲港口。
- 空运（AIR）：主要枢纽机场之间。

### 4.2 网络节点与连线设计（中国 ↔ 欧洲）

- 中国侧典型节点（建议）：
  - 港口：上海、宁波舟山、深圳（盐田）、青岛、天津等。
  - 机场：上海浦东、北京首都、广州白云、深圳宝安等。
  - 铁路枢纽：重庆、郑州、西安、武汉等（中欧班列始发地）。
  - 内陆仓储/分拨中心：义乌、东莞等。

- 欧洲侧典型节点（建议）：
  - 港口：鹿特丹、汉堡、安特卫普等。
  - 机场：法兰克福、阿姆斯特丹、巴黎戴高乐、伦敦希思罗等。
  - 铁路枢纽：杜伊斯堡、汉堡、华沙等。

- 典型连线（示意）：
  - 铁路：
    - 重庆 / 西安 / 郑州 → 杜伊斯堡 / 汉堡 / 华沙（中欧班列主通道）。
  - 海运：
    - 上海 / 宁波 / 深圳 → 鹿特丹 / 汉堡 / 其他北欧港。
  - 空运：
    - 上海浦东 / 北京 / 广州 → 法兰克福 / 阿姆斯特丹 / 巴黎。
  - 公路：
    - 内陆仓储 ↔ 港口 / 机场 / 铁路枢纽之间的集疏运。

### 4.3 行业默认参数（可在后台调整）

以下参数为「初始建议值」，实际项目中可根据业务经验在后台调节：

- 平均速度（粗略）：
  - 公路：60 km/h
  - 铁路：70–80 km/h（含边检/换装缓冲）
  - 海运：30–35 km/h（按航速换算）
  - 空运：750–850 km/h（空中飞行段）

- 单位运输成本（举例：元 / 吨·公里）：
  - 公路：0.8–1.2
  - 铁路：0.4–0.7
  - 海运：0.1–0.3
  - 空运：3.0–6.0

- 单位碳排放（举例：kg CO₂ / 吨·公里）：
  - 公路：0.06–0.08
  - 铁路：0.02–0.03
  - 海运：0.01–0.02
  - 空运：0.5–0.8

- 清关时间与费用（示意）：
  - 中国出口、欧洲进口各有一处清关节点：
    - 清关时间：每端 8–24 小时（可配置）。
    - 清关固定费用：按票计费 + 按货值百分比。

- 关税规则（简化版）：
  - 按货物分类定义一个关税率（例如普货 5–15%）。
  - 仅在跨境段生效（例如 CN → EU 进口端征税）。

以上所有参数需要在后台以配置项方式存储，前端仅使用计算结果，不直接写死数值。

---

## 5. 后端架构与 AI 引擎需求

### 5.1 是否需要后端 AI？—— 结论与分阶段方案

**结论：需要，并且建议分两步：**

1. **第一步：传统优化 + 规则引擎（必做）**
   - 使用图算法（最短路 / 最小成本路径）解决：
     - 在用户画出的网络骨架上，自动选择运输方式组合和路径。
     - 目标可以是时间、成本、碳排放或加权组合。
   - 通过规则引擎处理关税、清关、事件对时间与成本的影响。
   - 这一步完全可以基于你现有的阿里云机器 + 高德 Web 服务完成。

2. **第二步：接入大模型 / 学习型 AI（可选进阶）**
   - 典型用途：
     - 根据历史仿真结果自动调整参数建议（例如某段铁路长期延误，则建议提高时间系数）。
     - 生成自然语言分析与业务建议（例如在全球运营中枢里给出「增加某段运力」、「改用某种运输方式」建议）。
   - 可以考虑接入阿里云百炼/OpenAI 等大模型服务，以 API 方式调用。

本阶段需求文档聚焦于第 1 步（传统优化 + 规则引擎）作为基础能力，同时预留第 2 步可插拔接口。

### 5.2 后端组件划分

- API 网关 / Web 服务：
  - 提供 RESTful 接口给前端调用：
    - `/api/network/apply-scheme`：应用用户当前搭建的网络并返回可视化数据。
    - `/api/plan/route`：根据网络 + 起终点 + 目标（fast/cheap/green/balanced），返回最优多式联运方案。
    - `/api/config/...`：读取和更新参数（运输方式、关税、清关、事件默认值等）。

- 路径规划引擎：
  - 将网络骨架转为图结构：
    - 节点：物流节点（港口、机场、铁路场站、仓库）。
    - 边：用户画的连接，在后端扩展成带多种候选运输方式的「多层边」。
  - 根据当前参数、关税、事件，对每条边计算：
    - 时间、成本、碳排放、风险（可选）。
  - 对图运行优化算法，求解最优路径。

- 高德 Web 服务集成：
  - 使用后端环境变量中的 Web 服务 key 调用：
    - 驾车路线规划 API：计算两个节点之间的公路距离与时间。
  - 对查询结果做缓存，避免重复请求。

- 配置与参数管理：
  - 存储所有「默认参数」与「当前参数」。
  - 记录参数修改历史（便于排查与回滚）。
  - 支持恢复默认值。

- 事件与规则引擎：
  - 对于每条边，判断是否被哪些事件覆盖。
  - 处理跨国段是否需要关税与清关。
  - 根据事件和规则调整边的时间与成本。

### 5.3 AI / 算法细节（第一阶段）

- 图构建：
  - 节点：来源于前端传来的节点集合。
  - 边：来源于前端连线（双向/单向约定需明确），在后端扩展为多种候选运输方式。

- 边权重计算：
  - 对每个候选运输方式：
    - 距离：
      - 公路：高德驾车规划得出。
      - 铁路/海运/空运：来自预定义航线长度或近似计算。
    - 时间：
      - 距离 / 速度 + 清关时间 + 事件延时。
    - 成本：
      - 距离 × 单位成本 + 清关费用 + 关税成本。
    - 碳排放：
      - 距离 × 单位碳排放。

- 优化目标：
  - 最快：以时间为主要权重。
  - 最便宜：以成本为主要权重。
  - 低碳：以碳排为主要权重。
  - 综合：时间、成本、碳排按权重组合成一个综合指标，使用单目标最短路求解。

- 算法：
  - 初期可以使用 Dijkstra / A* 等单源最短路径算法。
  - 后续可考虑多目标优化（Pareto 前沿），但当前阶段可简化为加权求和。

---

## 6. 全屏数据分析视图需求（重命名「全屏驾驶舱」）

### 6.1 名称与定位

- 推荐名称：
  - 中文：`全球运营中枢` 或 `物流控制塔`
  - 英文：`LOGISTICS CONTROL TOWER`
- 定位：
  - 展示某一条或多条规划方案下的全局运营表现。
  - 为管理层、运营人员提供决策视图。

### 6.2 数据指标与可视化

- 核心 KPI：
  - 在途货量（TEU / 吨 / 票数）。
  - 平均运输时间（Transit Time）。
  - 总成本及拆分：运输成本 / 清关成本 / 关税成本。
  - 总碳排放量。
  - 准时率（On-time Delivery Ratio）。

- 重点分析视图：
  - 中国 ↔ 欧洲主通道分解：
    - 各运输方式占比（公路/铁路/海运/空运）。
    - 不同方案的时间、成本、碳排三维雷达图对比。
  - 事件影响分析：
    - 每个事件导致的延误时间与成本增加。
    - 有事件 vs 无事件的关键指标对比。
  - 成本结构分析：
    - 不同方案下运输 / 清关 / 关税占比对比图。
  - 网络热力图：
    - 不同线路上的货量与利用率可视化。

### 6.3 AI 演示动画需求

- 总体要求：
  - 在用户发起 AI 规划（例如选择「中国仓库 A → 欧洲仓库 B，目标：最快」）后，系统需要以「步骤化、可视化」方式向用户展示 AI 的决策过程，而不是只给出最终一条静态线。
  - 整体动画风格需与现有霓虹 / 科幻 UI 统一，流畅且节奏可控。

- 动画步骤示例（可按此逻辑扩展）：
  1. 高亮起点与终点：
     - 在地图上脉冲高亮 O、D 两个节点，并在侧栏显示「起点/终点」信息。
  2. 展示候选通道：
     - 以细线或半透明线的方式短暂显示多条候选主通道（例如：海运通道、铁路通道、空运通道），并在图例中标记不同颜色代表的运输方式。
  3. 逐段确认最优路径：
     - 按时间轴顺序，对最终选中的每一段路径执行「点亮」动画：
       - 线条从透明 → 高亮渐变。
       - 在线路中间浮现对应运输方式图标（🚚 / 🚂 / 🚢 / ✈️），短暂停留后淡出。
     - 对于跨境、清关节点：
       - 节点周围出现环形进度动画或「海关」图标，表示清关耗时。
  4. 事件影响演示：
     - 若某段路径受事件影响（台风、拥堵、关税上调等）：
       - 在该区域或节点上添加闪烁 / 波纹特效，配合文字提示（例如「台风导致耗时 +50%」）。
       - 将原本未受事件影响的路径对比显示（例如灰色细线），形成「有事件 vs 无事件」的视觉对比。
  5. 汇总视图：
     - 动画结束后，自动滚动或切换到控制塔视图中的「方案详情」面板：
       - 使用数值卡片和图表展示本次 AI 方案的时间 / 成本 / 碳排 / 关税 / 清关时间等关键指标。

- 动画控制：
  - 提供基础控制按钮：
    - 播放 / 暂停 / 重播。
    - 动画速度调节（例如：标准 / 快速）。
  - 若有多套方案（例如最快方案 vs 最便宜方案），支持在方案间切换时重新播放对应动画，并保持前后对比的一致体验。

---

## 7. 小结与后续实施顺序建议

1. **前端：完善「两阶段流程」与事件放置交互**
   - 阶段一：完全手工搭建网络（当前 demo 已基本具备）。
   - 阶段二入口：起点/终点选择 + 目标类型选择（按钮与面板设计）。
   - 事件放置：在地图上添加、编辑、删除事件。

2. **后端：搭建基础服务与参数管理**
   - 搭建 Node.js / Python API 服务框架。
   - 集成高德 Web 服务（使用环境变量中的 Web 服务 key）。
   - 建立参数配置存储（运输方式参数 / 关税清关 / 事件默认值）。

3. **后端：实现中国 ↔ 欧洲通道的路径规划引擎**
   - 建立中国与欧洲侧典型节点与示意航线/铁路线数据。
   - 实现图构建与边权重计算逻辑。
   - 实现单目标最短路算法（时间 / 成本 / 碳排 / 综合）。

4. **前后端联调：AI 方案可视化与控制塔视图**
   - 将后端返回的多式联运结果在地图上渲染成多段、不同颜色线路。
   - 将成本/时间/关税/事件影响等指标在控制塔视图中可视化。

5. **进阶：接入大模型 AI（可选）**
   - 用于自然语言分析与智能建议生成。
   - 用于根据历史场景自动调参或推荐更优方案。

本需求文档仅覆盖「接下来要干的活」在中国 ↔ 欧洲主通道上的整体设计与需实现的能力，为后续详细设计、任务拆解与开发排期提供基础。  

---

## 8. 视觉与动画设计规范（美术方向）

### 8.1 整体视觉风格

- 主题定位：
  - 深色系「未来物流控制塔」风格，突出科技感与专业感。
  - 以深蓝 / 近黑为背景，搭配高饱和霓虹色作为强调色。
- 主色系建议：
  - 主高亮色：霓虹蓝 `#00d2ff`（强调线路、边框、标题）。
  - 辅助强调色：霓虹粉 `#ff3366`（警告、异常、延误）。
  - 正向指标色：霓虹绿 `#00ff99`（良好状态、节省、低碳）。
  - 背景色：深蓝黑 `#050a14`，配合轻微网格 / 扫描线纹理。
- 字体：
  - 英文字体：科技风无衬线（如 Orbitron / Rajdhani），用于品牌与标题。
  - 中文字体：清晰易读的无衬线字体（系统默认即可）。

### 8.2 地图与节点视觉

- 地图背景：
  - 使用高德地图的暗色主题 / 自定义深色样式，使线路与节点在其上显得清晰。
  - 适度降低国界线、城市面层对比度，避免喧宾夺主。
- 节点样式：
  - 全球枢纽（L1）：较大圆形节点，霓虹粉外圈 + 多层发光效果。
  - 区域中心（L2）：中等圆形节点，霓虹蓝为主色，较弱发光。
  - 地方站点（L3）：小方块节点（仓库感），金黄色或淡蓝色，光晕适中。
  - 清关 / 关税节点：带「税」字或海关徽标样式的小圆点，金黄色边框 + 强发光。
- 节点动画：
  - 缓慢呼吸效果（scale 与透明度轻微变化）表示「在线、活跃」。
  - 选中节点增加外层环形波纹，短时持续。

### 8.3 线路与运输方式视觉

- 基础线路风格（仅用户手工连线阶段）：
  - 细线、半透明、单一颜色（例如暗青色），仅表示「潜在连接关系」，不强调运输方式。
- AI 最终方案线路风格：
  - 公路（ROAD）：霓虹蓝实线，适中粗细。
  - 铁路（RAIL）：淡灰 / 蓝灰虚线，略细于公路。
  - 海运（SEA）：青色长虚线，略粗，在线路两侧有微弱波纹特效。
  - 空运（AIR）：紫粉色弧形线段，线条略粗，带轻微光尾效果。
- 多方案对比：
  - 当前选中方案使用高饱和、较粗线条。
  - 其他方案使用同色系的淡色线条（降低不透明度），确保对比清晰但不杂乱。

### 8.4 UI 面板与参数面板

- 面板样式：
  - 背景：半透明深色面板（如 `rgba(5,10,20,0.9)`），带轻微模糊效果（毛玻璃感）。
  - 边框：主色系细边（霓虹蓝），圆角或切角设计突出科技感。
- 参数调节控件：
  - 使用滑块（Slider）呈现连续型参数（速度系数、成本系数、碳排系数、事件影响系数等）。
  - 使用开关（Toggle）切换启用/禁用某类事件或规则。
  - 数值框同时展示当前值与默认值，默认值以浅灰或标签形式呈现。
- 交互反馈：
  - 鼠标悬停按钮与滑块时，轻微发光与颜色增强。
  - 修改参数后，右上角短暂出现「已应用新参数」类型 Toast 提示。

### 8.5 AI 演示动画风格（与 6.3 配合）

- 镜头控制：
  - 开始演示时，摄像机缓慢缩放到整体路径大致范围。
  - 当逐段点亮路径时，镜头适度平移、缩放，确保当前段始终在视觉焦点区域。
- 线条点亮效果：
  - 使用「从起点向终点流动」的渐显动画（线条沿路径方向逐渐发亮）。
  - 线条光晕随时间轻微闪动，体现动态感。
- 节点与清关动画：
  - 起点/终点：增加环形扫描动画（类似雷达扫描），持续数秒后转为常态高亮。
  - 清关节点：显示环形进度条或旋转环，表示清关耗时，完成时轻微闪光。
- 事件呈现：
  - 天气事件（台风等）：半透明红色/橙色圆形区域，边缘带呼吸和微弱噪点动画。
  - 拥堵事件：节点或线路旁出现闪烁的感叹号图标，线条颜色偏向橙红。
  - 关税事件：相关段上出现金黄色闪烁线，或在节点上显示短暂「税」字动画。

### 8.6 控制塔视图布局建议

- 左侧：关键 KPI 数字卡片，采用大字体 + 霓虹描边。
- 中部：主地图区域，展示最终方案或多方案对比。
- 右侧 / 下方：图表区域：
  - 时间维度趋势（折线图）。
  - 成本与碳排放拆分（堆叠柱状图 / 饼图）。
  - 事件影响分析（条形图 / 时间轴）。
- 动画节奏：
  - 进入控制塔视图时，卡片与图表从底部或侧边滑入，并伴随轻微渐显。
  - 图表加载时，柱状/线条使用适度的增长动画，避免突兀。

---

## 9. 实施操作指南（你需要怎么做）

### 9.1 现有原型的快速体验与演示

- 本地快速查看：
  - 确保机器可以访问外网（高德地图需要联网）。
  - 使用任意本地静态服务器打开前端页面（避免直接用 `file://` 打开）：
    - 方式一：IDE 插件（如 VS Code Live Server）。
    - 方式二：Node 环境下执行 `npx serve .` 或类似工具，在浏览器访问 `http://localhost:3000/demo.html`。
  - 进入页面后：
    - 点击「启动系统」，等待地图加载。
    - 使用左侧工具栏添加节点、建立连线，体验参数面板与 AI 路径演示按钮。

- 在阿里云 ECS 上部署静态前端（示例方案）：
  - 确保 ECS 上已安装 Docker 与 docker-compose。
  - 使用仓库中 `deployment/docker-compose.yml` 与 `deployment/DEPLOY_GUIDE.md`：
    - 将打包好的前端文件（包含 `demo.html` 与静态资源）放入 `deployment/html` 目录。
    - 在 `deployment` 目录执行：`docker-compose up -d`。
    - 在浏览器访问 ECS 公网 IP 的 80 端口（例如 `http://你的ECS公网IP/`）。
  - 在阿里云控制台中检查安全组规则，开放 TCP 80 端口。

### 9.2 前端开发的完善工作（基于本需求文档）

在当前 demo 的基础上，前端需要重点完成：

- 两阶段流程补完：
  - 阶段一：继续优化「手工搭建网络骨架」体验（节点管理、连线模式、删除/调整）。
  - 阶段二入口：
    - 在 UI 中增加「选择起点/终点 + 目标类型（最快/最便宜/低碳/综合）」的面板或弹窗。
    - 将用户选择打包成请求参数，准备调用后端 `/api/plan/route`。

- 事件放置与编辑：
  - 按 3.1 的设计，为事件增加侧边栏入口（天气/拥堵/关税/线路中断）。
  - 支持在地图上点击放置事件、查看详情、启用/禁用、删除。
  - 在前端将事件结构序列化，与当前网络一同发送给后端规划引擎。

- 参数面板联通后端：
  - 当前前端已支持参数滑块与重置逻辑，本阶段需：
    - 在调整参数后调用 `/api/config/...` 接口，将当前参数写入后端。
    - 打开页面时从后端拉取最新参数，填充前端参数面板。
  - 确保「默认值 / 当前值 / 恢复默认」的行为与后端存储一致。

- AI 动画与控制塔视图细化：
  - 将 6.3 与 8.5 中的动画步骤拆解为可配置流程：
    - 高亮起终点 → 候选通道 → 逐段点亮 → 事件特效 → 控制塔汇总。
  - 与后端返回的数据结构对齐（包括每段路径的运输方式、时间、成本、事件影响等），在动画过程中同步在侧栏或控制塔中展示文字说明与数值变化。

### 9.3 后端与算法开发的实施步骤

为满足中国 ↔ 欧洲多式联运规划与参数配置需求，建议按以下顺序落地后端：

1. 基础服务与配置管理：
   - 选择技术栈（例如 Node.js + Express 或 Python + FastAPI）。本仓库已在 `backend/server.js` 中提供 Node.js + Express 示例实现。
   - 搭建 RESTful API 骨架，实现：
     - `/api/config/get`：获取当前参数与默认参数。
     - `/api/config/update`：更新部分或全部参数。
     - `/api/config/reset`：恢复默认参数。
   - 引入配置存储（可先用 JSON / SQLite / PostgreSQL，视团队情况而定）。

2. 高德 Web 服务集成：
   - 在后端配置高德 Web 服务 key（使用环境变量，不写入前端）。
   - 封装调用「驾车路线规划」接口的工具函数，提供：
     - 输入：起点经纬度、终点经纬度。
     - 输出：距离、预估时间、可能的路线形状（用于可视化）。
   - 加入缓存策略，避免重复调用同一 OD 对。

3. 路径规划引擎：
   - 按 4.x 与 5.3 的要求，实现：
     - 图结构构建（节点、边、多种运输方式）。
     - 边权重计算（时间、成本、碳排、风险）。
     - 事件与关税规则的叠加影响。
   - 为 `/api/plan/route` 提供：
     - 输入：前端传来的节点、连线、事件、参数、起点/终点、优化目标。
     - 输出：分段的多式联运方案（每段包含运输方式、时间、成本、碳排、事件说明等）。

   - 在当前示例中：
     - 若前端未传入节点和连线，`backend/server.js` 会使用内置的「中国 ↔ 欧洲」示意网络进行规划（起点默认上海，终点默认杜伊斯堡），便于快速验证。
     - 前端后续可以按接口约定，将用户绘制的网络骨架序列化后传给 `/api/plan/route`，由后端执行真实规划。

4. 网络应用与多方案：
   - 实现 `/api/network/apply-scheme`，支持保存与读取方案（方案一、方案二等）。
   - 在后端对同一网络生成多套方案（最快/最便宜/低碳/综合），供前端对比展示。

### 9.4 团队分工与节奏建议

- 建议配置的角色：
  - 前端工程：1–2 人，负责地图交互、参数面板、动画与数据可视化。
  - 后端工程：1–2 人，负责 API、路径规划引擎、参数存储与高德 Web 服务集成。
  - 美术/设计：1 人（可兼职），负责整体视觉、动画细节与演示版效果把控。

- 推荐迭代节奏（示例）：
  - 第 1 周：前端交互与事件放置完善，后端框架 + 配置管理初版。
  - 第 2–3 周：中国 ↔ 欧洲路径规划引擎与高德 Web 服务集成，前后端联调基础方案。
  - 第 4 周：控制塔视图与 AI 演示动画精修，准备一套对外演示的「标准场景」。
  - 后续：接入大模型 AI、扩展至更多区域与真实业务数据。

通过以上步骤，你可以基于本文档完成从「炫酷演示原型」到「可用于业务沟通与决策支持的中国 ↔ 欧洲物流模拟器」的一整套落地过程。
